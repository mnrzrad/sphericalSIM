% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/stereographic.R
\name{jacobian_inv_stereo}
\alias{jacobian_inv_stereo}
\title{Jacobian of Inverse Stereographic Projection}
\usage{
jacobian_inv_stereo(u)
}
\arguments{
\item{u}{Vector of length (q-1) representing a point in Euclidean space.}
}
\value{
Matrix of dimension q × (q-1) containing the Jacobian. Each column j
  contains the partial derivatives of π^(-1)(u) with respect to u_j.
}
\description{
Computes the Jacobian matrix of the inverse stereographic projection at a
given point u in R^(q-1).
}
\details{
For the inverse stereographic projection π^(-1): R^(q-1) → S^(q-1), the
Jacobian J(u) is a q × (q-1) matrix where each column j contains the partial
derivatives with respect to u_j:

For i = 1, ..., q-1:
\deqn{∂π_i^(-1)/∂u_j = \frac{2δ_{ij}}{1 + ||u||^2} - \frac{4u_i u_j}{(1 + ||u||^2)^2}}

For i = q (the last component):
\deqn{∂π_q^(-1)/∂u_j = -\frac{4u_j}{(1 + ||u||^2)^2}}

where δ_{ij} is the Kronecker delta (1 if i=j, 0 otherwise).

The Jacobian is used in:
\itemize{
  \item Change-of-variables calculations
  \item Computing derivatives of composed functions via chain rule
  \item Gradient-based optimization on spherical manifolds
}
}
\examples{
# Jacobian at origin
J0 <- jacobian_inv_stereo(c(0, 0))
print(J0)  # Simple diagonal-like structure at origin

# Jacobian at non-origin point
u <- c(1, 1)
J <- jacobian_inv_stereo(u)

# Verify dimensions
q_minus_1 <- length(u)
q <- q_minus_1 + 1
dim(J)  # Should be [q, q-1]

# Numerical verification using finite differences
\dontrun{
library(numDeriv)
u_test <- c(0.5, 0.5)

# Our analytical Jacobian
J_analytical <- jacobian_inv_stereo(u_test)

# Numerical Jacobian
J_numerical <- jacobian(inv_stereo, u_test)

# Compare
max(abs(J_analytical - J_numerical))  # Should be very small
}

}
\seealso{
\code{\link{inv_stereo}} for the inverse stereographic projection
}
