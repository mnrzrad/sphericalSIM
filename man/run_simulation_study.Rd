% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/simulation.R
\name{run_simulation_study}
\alias{run_simulation_study}
\title{Run Simulation Study for Spherical Single-Index Model}
\usage{
run_simulation_study(
  n_sim = 50,
  n = 500,
  p = 100,
  q = 3,
  G = 10,
  active_groups = c(1, 3, 5),
  use_adaptive = TRUE,
  adaptive_method = "fast",
  parallel = TRUE,
  n_cores = NULL,
  save_file = "simulation_results.rds",
  verbose_sim = FALSE
)
}
\arguments{
\item{n_sim}{Number of simulation replications to run (default 50)}

\item{n}{Sample size for each simulation (default 500)}

\item{p}{Total number of predictors (default 100)}

\item{q}{Response dimension on sphere (default 3)}

\item{G}{Total number of groups (default 10)}

\item{active_groups}{Vector of true active group indices (default c(1, 3, 5))}

\item{use_adaptive}{Use adaptive group lasso weights (default TRUE)}

\item{adaptive_method}{Method for computing adaptive weights: "fast" or "grouplasso" (default "fast")}

\item{parallel}{Use parallel processing (default TRUE)}

\item{n_cores}{Number of cores for parallel processing. If NULL, uses detectCores() - 1 (default NULL)}

\item{save_file}{File path to save results as RDS file. If NULL, results are not saved (default "simulation_results.rds")}

\item{verbose_sim}{Print detailed progress for each simulation (default FALSE)}
}
\value{
List of results from all successful simulations. Each element is a list
  returned by \code{\link{run_single_simulation}} containing:
  \itemize{
    \item Estimation results (beta_est, m_est, selected_groups)
    \item Performance metrics (TPR, FPR, angular_error, link_mse, etc.)
    \item Tuning parameters (best_lambda, best_gamma, weights)
    \item Convergence information (converged, n_iter)
  }
}
\description{
Conducts a comprehensive simulation study by running multiple replications
of spherical single-index model estimation with group lasso. Supports both
sequential and parallel execution.
}
\details{
The function performs the following steps:
\enumerate{
  \item Prints study configuration and start time
  \item Runs n_sim independent simulations via \code{\link{run_single_simulation}}
  \item Handles errors gracefully, excluding failed simulations from results
  \item Saves results to RDS file if save_file is specified
  \item Reports completion summary and end time
}

When parallel = TRUE, the function uses \code{mclapply} from the parallel package
to distribute simulations across multiple cores. Error handling ensures that
failures in individual simulations do not crash the entire study.

Each simulation uses a unique seed (seed_offset + sim_id) to ensure reproducibility
while maintaining independence between replications.
}
\examples{
\dontrun{
# Run 50 simulations with default settings (parallel)
results <- run_simulation_study(
  n_sim = 50,
  save_file = "my_results.rds"
)

# Sequential execution with verbose output
results <- run_simulation_study(
  n_sim = 10,
  parallel = FALSE,
  verbose_sim = TRUE,
  save_file = NULL
)

# Custom settings with parallel processing
results <- run_simulation_study(
  n_sim = 100,
  n = 200,
  p = 50,
  G = 5,
  active_groups = c(1, 2),
  adaptive_method = "grouplasso",
  n_cores = 4,
  save_file = "custom_study.rds"
)

# Analyze results
summary <- summarize_results(results)
}

}
\seealso{
\code{\link{run_single_simulation}} for single simulation execution,
\code{\link{summarize_results}} for analyzing simulation results
}
